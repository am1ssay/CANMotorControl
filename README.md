**Project Name:**  
**CANMotorControl**  
*Управление моторами и мониторинг энкодеров через CAN-интерфейс*

---

# CANMotorControl  
Комплексная система для управления шаговыми/DC моторами и мониторинга энкодеров через CAN-шину с графическим интерфейсом.

## Возможности  
✅ **Управление моторами:**  
- Шаговые двигатели (скорость/направление/количество шагов)  
- DC двигатели (включение/выключение, направление)  

✅ **Мониторинг энкодеров:**  
- Отображение текущего угла и дельты изменения  
- Автоматический подсчет полных оборотов  
- Визуализация в реальном времени с цветовой индикацией  

✅ **Администрирование:**  
- Смена Node ID энкодеров  
- Обнуление позиции энкодера  
- Диагностика CAN-шины  

## Требования  
- Raspberry Pi с активным CAN-интерфейсом  
- Python 3.10+  
- Зависимости:  
  ```bash
  python-can==4.3.0
  canopen==2.2.0
  pyserial==3.5
  tkinter
  ```

## Установка  
1. Клонируйте репозиторий:  
   ```bash
   git clone https://github.com/yourname/CANMotorControl.git
   cd CANMotorControl
   ```

2. Настройте CAN-интерфейс на Raspberry Pi:  
   ```bash
   sudo ip link set can0 type can bitrate 1000000
   sudo ip link set up can0
   ```

3. Установите зависимости:  
   ```bash
   pip install -r requirements.txt
   ```

## Использование  
1. **Запуск сервера на Raspberry Pi:**  
   ```bash
   python server.py
   ```

2. **Запуск клиента на ПК:**  
   ```bash
   python pc_client.py
   ```

3. **Основные команды в интерфейсе:**  
   - `Показать данные энкодера` - запуск мониторинга  
   - `Сменить ID энкодера` - интерактивный диалог  
   - `Обнулить позицию` - сброс текущего угла  

Описание функционала файлов:
________________________________________
dc_motor.py
•	Назначение: Управление DC-двигателем через CAN-шину.
•	Функционал:
o	Отправка команд на включение/выключение питания и изменение направления вращения.
o	Валидация ID мотора (должен быть в диапазоне 2XX/3XX).
o	Формирование CAN-сообщений с данными (состояние питания, направление).
o	Пример использования через консоль: ручной ввод параметров для тестирования.
________________________________________
enc_change_id.py
•	Назначение: Изменение Node ID энкодера в CANopen-сети.
•	Функционал:
o	Подключение к CAN-сети и изменение Node ID через SDO-запросы.
o	Сохранение параметров в EEPROM и перезагрузка узла.
o	Проверка допустимого диапазона нового ID (1-127).
o	Обработка ошибок связи и автоматическое обновление конфигурации.
________________________________________
encoders.py
•	Назначение: Мониторинг и управление энкодерами через CAN-шину.
•	Функционал:
o	Загрузка конфигурации из JSON-файла (разрешение, калибровка, ID энкодеров).
o	Расчет угла, дельты и абсолютного положения энкодера.
o	Сброс позиции через Preset Value (объект 0x6003).
o	Режим реального времени с выводом данных в консоль.
o	Поддержка управления через клавиатуру (сброс, активация движения).
________________________________________
server.py
•	Назначение: Сервер для управления устройствами через сеть.
•	Функционал:
o	Прием TCP-подключений от клиентов.
o	Обработка команд:
	Запуск/остановка мониторинга энкодеров.
	Изменение Node ID энкодера.
	Сброс позиции энкодера.
	Управление шаговым и DC-двигателями.
o	Рассылка данных энкодеров клиентам в реальном времени.
o	Интеграция с классами MultiEncoderMonitor, MoveStepMotor и др.
________________________________________
step_motor.py
•	Назначение: Управление шаговым двигателем через CAN-шину.
•	Функционал:
o	Отправка команд с параметрами: питание, направление, количество шагов.
o	Ожидание подтверждения от двигателя (ответ с ID 0x101 и байтом 0xAA).
o	Проверка корректности входных данных (0 ≤ шаги ≤ 1024).
o	Пример использования через консоль для тестирования.
________________________________________
client.py
•	Назначение: Графический интерфейс для удаленного управления.
•	Функционал:
o	Подключение к серверу по IP-адресу.
o	Управление энкодерами:
	Смена Node ID.
	Сброс позиции.
o	Управление моторами:
	Шаговый двигатель (питание, направление, шаги).
	DC-двигатель (ID, питание, направление).
o	Отображение данных энкодеров в реальном времени.
o	Логирование статуса операций в текстовом поле.
________________________________________
Связи между компонентами:
•	Сервер (server.py) выступает промежуточным звеном между клиентом и устройствами.
•	Клиент (client.py) отправляет команды через TCP, а сервер делегирует их соответствующим модулям:
o	dc_motor.py и step_motor.py — для управления двигателями.
encoders.py и enc_change_id.py — для работы с энкодерами.
•	Все компоненты используют CAN-шину для взаимодействия с физическими устройствами.


## Лицензия  
Подробности в файле [LICENSE](LICENSE)
